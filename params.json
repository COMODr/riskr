{"name":"Riskr","tagline":"","body":"# riskr\r\n<!-- README.md is generated from README.Rmd -->\r\n\r\n\r\n\r\n## Introduction\r\n\r\nThe `riskr` package facilitate repetitive *bussines risk* (or other areas) tasks. In general this package helps to:\r\n\r\n 1. Measure in a easy way the performance of models via wrapper or shortcuts from ROCR functions.\r\n 2. Visualize relationships between variables.\r\n 3. Facilitate the usual and repetitives tasks.\r\n\r\n## Installation\r\n\r\nYou can install the latest development version from github with:\r\n\r\n\r\n```r\r\ndevtools::install_github(\"jbkunst/riskr\")\r\n```\r\n\r\n## Facts\r\n\r\n`riskr` assume the target variable is binary with numeric values: 0 and 1. Usually 1 means the characteristic of interest.\r\n\r\n## Functions\r\n\r\nUsually we have a data frame with a *target* variable and a *score* (or probability) like this:\r\n\r\n\r\n```r\r\nlibrary(\"riskr\")\r\n\r\ndata(\"predictions\")\r\n\r\nhead(predictions)\r\n```\r\n\r\n\r\n\r\n| score| target|\r\n|-----:|------:|\r\n| 0.202|      1|\r\n| 0.806|      1|\r\n| 0.513|      1|\r\n| 0.052|      0|\r\n| 0.329|      1|\r\n| 0.246|      0|\r\n\r\n```r\r\n\r\nstr(predictions)\r\n#> 'data.frame':\t10000 obs. of  2 variables:\r\n#>  $ score : num  0.2023 0.8058 0.5134 0.0525 0.3288 ...\r\n#>  $ target: num  1 1 1 0 1 0 1 0 1 1 ...\r\n\r\nscore <- predictions$score\r\n\r\ntarget <- predictions$target\r\n```\r\n\r\n### Performance Indicators\r\n\r\nThe main statistics or indicators are KS, AUCROC so:\r\n\r\n\r\n```r\r\nks(score, target)\r\n#> [1] 0.254\r\n\r\naucroc(score, target)\r\n#> [1] 0.676\r\n\r\ngini(score, target)\r\n#> [1] 0.353\r\n\r\nscore_indicators(score, target)\r\n```\r\n\r\n\r\n\r\n| count| target_count| target_rate|    ks| aucroc|  gini|\r\n|-----:|------------:|-----------:|-----:|------:|-----:|\r\n| 10000|         6990|       0.699| 0.254|  0.676| 0.353|\r\n\r\n```r\r\n\r\nplot_roc(score, target)\r\n#> Warning: package 'scales' was built under R version 3.2.1\r\n```\r\n\r\n<img src=\"vignettes/figures/unnamed-chunk-4-1.png\" title=\"\" alt=\"\" style=\"display: block; margin: auto;\" />\r\n\r\n```r\r\n\r\nplot_gain(score, target)\r\n```\r\n\r\n<img src=\"vignettes/figures/unnamed-chunk-4-2.png\" title=\"\" alt=\"\" style=\"display: block; margin: auto;\" />\r\n\r\n### Odds Table\r\n\r\nThe odds table are other way to show how a score/model performs.\r\n\r\n\r\n```r\r\nscore <- round(predictions$score * 1000)\r\n\r\nodds_table(score, target, nclass = 4)\r\n```\r\n\r\n\r\n\r\n|variable  | count| percent| target_count| target_rate| target_percent| odds|\r\n|:---------|-----:|-------:|------------:|-----------:|--------------:|----:|\r\n|[1,199]   |  2502|   0.250|         1304|       0.521|          0.187| 1.09|\r\n|(199,430] |  2504|   0.250|         1661|       0.663|          0.238| 1.97|\r\n|(430,683] |  2502|   0.250|         1894|       0.757|          0.271| 3.12|\r\n|(683,996] |  2492|   0.249|         2131|       0.855|          0.305| 5.90|\r\n\r\n```r\r\n\r\nodds_table(score, target, breaks = c(0, 300, 700, 999))\r\n```\r\n\r\n\r\n\r\n|variable  | count| percent| target_count| target_rate| target_percent| odds|\r\n|:---------|-----:|-------:|------------:|-----------:|--------------:|----:|\r\n|(0,300]   |  3675|   0.368|         2052|       0.558|          0.294| 1.26|\r\n|(300,700] |  3978|   0.398|         2926|       0.736|          0.419| 2.78|\r\n|(700,999] |  2347|   0.235|         2012|       0.857|          0.288| 6.01|\r\n\r\n### Confusion Matrix\r\n\r\n\r\n```r\r\nscore_cat <- ifelse(score < 500, 0, 1)\r\n\r\nconf_matrix(score_cat, target)\r\n#> $confusion.matrix\r\n#>    class pred 0 pred 1\r\n#> 0 true 0   2230    780\r\n#> 1 true 1   3476   3514\r\n#> \r\n#> $indicators\r\n#>                               term term.short value\r\n#> 1                         Accuracy         AC 0.574\r\n#> 2 Recall | True Positive rate (GG)     Recall 0.503\r\n#> 3              False Positive rate         FP 0.259\r\n#> 4          True Negative rate (BB)         TN 0.741\r\n#> 5              False Negative rate         FN 0.497\r\n#> 6                        Precision          P 0.818\r\n#> \r\n#> $indicators.t\r\n#>      AC Recall    FP    TN    FN     P\r\n#> 1 0.574  0.503 0.259 0.741 0.497 0.818\r\n```\r\n\r\n### Bivariate Tables\r\n\r\n\r\n```r\r\ndata(\"credit\")\r\n\r\nstr(credit)\r\n#> 'data.frame':\t49694 obs. of  17 variables:\r\n#>  $ id_client          : int  1 7 9 12 14 19 22 26 28 30 ...\r\n#>  $ sex                : chr  \"F\" \"F\" \"F\" \"F\" ...\r\n#>  $ marital_status     : chr  \"O\" \"S\" \"S\" \"C\" ...\r\n#>  $ age                : int  44 22 27 32 36 46 17 20 71 46 ...\r\n#>  $ flag_res_phone     : chr  \"N\" \"Y\" \"Y\" \"Y\" ...\r\n#>  $ area_code_res_phone: int  31 31 31 31 31 50 50 50 31 31 ...\r\n#>  $ payment_day        : int  12 12 20 12 12 12 12 12 18 8 ...\r\n#>  $ residence_type     : chr  \"P\" \"A\" \"A\" \"P\" ...\r\n#>  $ months_in_residence: int  12 0 0 24 120 360 12 12 96 72 ...\r\n#>  $ months_in_the_job  : int  48 48 0 0 36 120 12 24 12 12 ...\r\n#>  $ profession_code    : int  731 999 950 165 15 704 38 39 13 801 ...\r\n#>  $ flag_other_card    : chr  \"N\" \"N\" \"N\" \"N\" ...\r\n#>  $ flag_mobile_phone  : chr  \"N\" \"N\" \"N\" \"N\" ...\r\n#>  $ flag_contact_phone : chr  \"N\" \"N\" \"N\" \"N\" ...\r\n#>  $ personal_net_income: num  300 410 1000 700 1987 ...\r\n#>  $ quant_add_cards    : int  0 0 0 0 1 0 0 0 0 0 ...\r\n#>  $ bad                : int  0 0 1 0 0 0 1 1 0 0 ...\r\n\r\nft(credit$marital_status)\r\n```\r\n\r\n\r\n\r\n|class | count| percent|\r\n|:-----|-----:|-------:|\r\n|C     | 17097|   0.344|\r\n|D     |  2142|   0.043|\r\n|O     |  2776|   0.056|\r\n|S     | 25249|   0.508|\r\n|V     |  2430|   0.049|\r\n\r\n```r\r\n\r\nbt(credit$marital_status, credit$bad)\r\n```\r\n\r\n\r\n\r\n|variable | count| percent| target_count| target_rate| target_percent|  odds|\r\n|:--------|-----:|-------:|------------:|-----------:|--------------:|-----:|\r\n|C        | 17097|   0.344|         2483|       0.145|          0.253| 0.170|\r\n|D        |  2142|   0.043|          322|       0.150|          0.033| 0.177|\r\n|O        |  2776|   0.056|          660|       0.238|          0.067| 0.312|\r\n|S        | 25249|   0.508|         6059|       0.240|          0.617| 0.316|\r\n|V        |  2430|   0.049|          289|       0.119|          0.029| 0.135|\r\n\r\n```r\r\n\r\nlibrary(\"ggplot2\")\r\n\r\ncredit$age_bin <- cut_interval(credit$age, 4)\r\n\r\nbt(credit$age_bin, credit$bad)\r\n```\r\n\r\n\r\n\r\n|variable | count| percent| target_count| target_rate| target_percent|  odds|\r\n|:--------|-----:|-------:|------------:|-----------:|--------------:|-----:|\r\n|[15,35]  | 28377|   0.571|         7015|       0.247|          0.715| 0.328|\r\n|(35,55]  | 17425|   0.351|         2473|       0.142|          0.252| 0.165|\r\n|(55,75]  |  3767|   0.076|          313|       0.083|          0.032| 0.091|\r\n|(75,95]  |   125|   0.003|           12|       0.096|          0.001| 0.106|\r\n\r\n```r\r\n\r\nplot_bt(credit$age_bin, credit$bad) + ggtitle(\"Age\")\r\n```\r\n\r\n<img src=\"vignettes/figures/unnamed-chunk-7-1.png\" title=\"\" alt=\"\" style=\"display: block; margin: auto;\" />\r\n\r\n```r\r\n\r\nplot_bt(credit$flag_res_phone, credit$bad,\r\n        count.labels = TRUE, target.labels = TRUE) +\r\n  ggtitle(\"Flag Response Phone\")\r\n```\r\n\r\n<img src=\"vignettes/figures/unnamed-chunk-7-2.png\" title=\"\" alt=\"\" style=\"display: block; margin: auto;\" />\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}